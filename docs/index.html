<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Install FLACloader Bookmarklet</title>
    <style>
      body {
        font-family: sans-serif;
        padding: 40px;
        background: #111;
        color: #eee;
      }
      a.bookmarklet {
        display: inline-block;
        padding: 10px 20px;
        background: #2288ff;
        color: white;
        font-weight: bold;
        text-decoration: none;
        border-radius: 8px;
        margin-top: 20px;
      }
    </style>
  </head>
  <body>
    <h1>ðŸŽµ FLACloader Bookmarklet</h1>
    <p>Drag the button below to your bookmarks bar:</p>
    <a class="bookmarklet" href="javascript:(function(){(async()=>{const e=e=>new Promise((n=>setTimeout(n,e))),n=document.createElement("style");n.textContent="\n    #flac-helper-container {\n      position: fixed;\n      top: 60px;\n      right: 20px;\n      z-index: 99999;\n      background: #000000;\n      border: 1px solid #222;\n      box-shadow: 0 2px 10px rgba(0,0,0,0.8);\n      max-height: 80vh;\n      overflow-y: auto;\n      width: 360px;\n      font-family: sans-serif;\n      padding: 10px;\n      border-radius: 8px;\n      color: #eee;\n      /* Remove overflow: hidden to allow scrolling */\n    }\n    #flac-helper-container h2 {\n      font-size: 16px;\n      margin-bottom: 10px;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      color: #aad4ff;\n      position: relative;\n      z-index: 10;\n    }\n    #flac-helper-close {\n      cursor: pointer;\n      font-weight: bold;\n      font-size: 16px;\n      border: none;\n      background: none;\n      color: #aad4ff;\n      position: relative;\n      z-index: 10;\n    }\n    #flac-helper-container button {\n      margin: 5px 5px 10px 0;\n      padding: 6px 10px;\n      font-size: 13px;\n      cursor: pointer;\n      background: #112244;\n      border: 1px solid #224488;\n      color: #aad4ff;\n      border-radius: 4px;\n      position: relative;\n      z-index: 10;\n      transition: background 0.3s ease;\n    }\n    #flac-helper-container button:hover {\n      background: #224488;\n    }\n    #flac-helper-list {\n      display: flex;\n      flex-direction: column;\n      gap: 6px;\n      position: relative;\n      z-index: 10;\n    }\n    .flac-helper-item {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      padding: 4px;\n      border-bottom: 1px solid #222;\n      color: #ccc;\n      position: relative;\n      z-index: 10;\n    }\n    .flac-helper-item img {\n      width: 60px;\n      height: 34px;\n      object-fit: cover;\n      background: #111;\n      border-radius: 4px;\n    }\n    .flac-helper-title {\n      flex: 1;\n      font-size: 13px;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n      color: #aad4ff;\n    }\n    #flac-helper-loading {\n      font-size: 13px;\n      margin-bottom: 10px;\n      color: #666;\n      position: relative;\n      z-index: 10;\n    }\n    #radial-blur-canvas {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      pointer-events: none;\n      z-index: 0;\n      border-radius: 8px;\n    }\n  ",document.head.appendChild(n);const t=document.createElement("div");t.id="flac-helper-container";const o=document.createElement("canvas");o.id="radial-blur-canvas",t.appendChild(o);const i=document.createElement("div");i.id="flac-helper-content-wrapper",i.style.position="relative",i.style.zIndex="10",i.style.overflowY="auto",i.style.maxHeight="80vh",i.style.height="100%",i.style.padding="10px",t.appendChild(i);const l=o.getContext("2d");function c(){o.width=t.clientWidth,o.height=t.clientHeight}c(),window.addEventListener("resize",c);let r=o.width/2,a=o.height/2,d=r,p=a;t.addEventListener("mousemove",(e=>{const n=o.getBoundingClientRect();d=e.clientX-n.left,p=e.clientY-n.top})),function e(){r+=.02*(d-r),a+=.02*(p-a),l.clearRect(0,0,o.width,o.height);const n=l.createRadialGradient(r,a,50,r,a,200);n.addColorStop(0,"rgba(0, 120, 255, 0.4)"),n.addColorStop(1,"rgba(0, 0, 0, 0)"),l.fillStyle=n,l.fillRect(0,0,o.width,o.height),requestAnimationFrame(e)}();const s=document.createElement("h2");s.innerText="ðŸŽµ FLACloader - YT";const h=document.createElement("button");h.id="flac-helper-close",h.textContent="âœ•",h.onclick=()=>t.remove(),s.appendChild(h),i.appendChild(s);const u=document.createElement("div");u.id="flac-helper-loading",u.textContent="ðŸ”„ Loading full playlist...",i.appendChild(u),document.body.appendChild(t);const m=new Map,f=()=>{const e=document.querySelectorAll("#items ytd-playlist-panel-video-renderer");for(let n of e){const e=n.querySelector("a#wc-endpoint");if(!e)continue;const t=e.getAttribute("href"),o=t?.match(/v=([^&]+)/);if(!o)continue;const i=o[1];if(m.has(i))continue;const l="https://www.youtube.com"+t.split("&")[0],c=n.querySelector("#video-title"),r=c?.getAttribute("title")?.trim()||"Untitled",a=n.querySelector("#thumbnail img");let d="";if(a?.src?.startsWith("data:")||!a?.src){d=%60https://i.ytimg.com/vi/${i}/hqdefault.jpg%60}else d=a.src;m.set(i,{url:l,title:r,img:d})}},x=(document.querySelector("#items"),async(n="down")=>{let t=-1,o="",i=0;for(;;){const l=document.querySelectorAll("#items ytd-playlist-panel-video-renderer");if(!l.length)break;const c=l["down"===n?l.length-1:0];f(),c.scrollIntoView({behavior:"smooth",block:"center"}),await e(300);const r=c.querySelector("a#wc-endpoint"),a=r?.getAttribute("href");if(a===o){if(i++,i>=2)break}else o=a,r?.click(),await e(2e3),f(),t=l.length,i=0}});await x("down"),await x("up");const g=Array.from(document.querySelectorAll("#items ytd-playlist-panel-video-renderer"));for(let n of g)n.scrollIntoView({behavior:"instant",block:"center"}),await e(30);f(),u.remove();const b=document.createElement("button");b.textContent="Select All";const y=document.createElement("button");y.textContent="Deselect All";const v=document.createElement("button");v.textContent="ðŸ“¥ Download Selected (FLAC)",i.appendChild(b),i.appendChild(y),i.appendChild(v);const w=document.createElement("div");w.id="flac-helper-list",i.appendChild(w);const C=Array.from(m.values());C.forEach(((e,n)=>{const t=document.createElement("div");t.className="flac-helper-item";const o=document.createElement("input");o.type="checkbox",o.dataset.index=n,o.checked=!0;const i=document.createElement("img");i.src=e.img;const l=document.createElement("div");l.className="flac-helper-title",l.textContent=e.title,t.appendChild(o),t.appendChild(i),t.appendChild(l),w.appendChild(t)})),b.onclick=()=>{w.querySelectorAll("input[type='checkbox']").forEach((e=>e.checked=!0))},y.onclick=()=>{w.querySelectorAll("input[type='checkbox']").forEach((e=>e.checked=!1))},v.onclick=()=>{const e=Array.from(w.querySelectorAll("input[type='checkbox']")).filter((e=>e.checked)).map((e=>C[parseInt(e.dataset.index)].url));if(!e.length)return void alert("Please select at least one video.");const n=new Blob([JSON.stringify(e.map((e=>({url:e}))),null,2)],{type:"application/json"}),t=document.createElement("a");t.href=URL.createObjectURL(n),t.download=%60PlaylistDownloader_${Date.now()}.json%60,t.click()}})();}());">FLACloader- YT</a>
  </body>
</html>
